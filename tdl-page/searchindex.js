Search.setIndex({"docnames": ["TP1_Full", "TP2_Full", "TP3_Full", "TP5_Full", "TP6_Full", "intro"], "filenames": ["TP1_Full.ipynb", "TP2_Full.ipynb", "TP3_Full.ipynb", "TP5_Full.ipynb", "TP6_Full.ipynb", "intro.md"], "titles": ["TD 1: Single Layer Perceptron", "TP2 : Approximation with neural networks", "TP3 : Lazy training", "TP5 : Neural Tangent Kernel", "TP6 : PAC-Bayes", "Theoretical Principles of Deep Learning"], "terms": {"goal": [0, 1, 4, 5], "everyon": 0, "can": [0, 1, 3], "notebook": [0, 4], "appropri": 0, "config": 0, "plai": 0, "around": 0, "h\u00e9di": 0, "hadiji": [0, 4, 5], "bit": [0, 4], "from": [0, 2, 3, 4, 5], "odalr": 0, "ambryn": 0, "maillard": 0, "decemb": 0, "2023": 0, "import": [0, 1, 2, 3, 4], "sy": 0, "nn": [0, 1, 2, 3, 4], "function": 0, "f": [0, 1, 2, 3, 4], "numpi": [0, 1, 2, 3, 4], "np": [0, 1, 2, 3, 4], "random": [0, 1, 2, 3, 4], "copi": [0, 2, 4], "deepcopi": [0, 4], "matplotlib": [0, 1, 2, 3, 4], "pyplot": [0, 1, 2, 3, 4], "plt": [0, 1, 2, 3, 4], "If": 0, "necessari": [0, 1], "instal": 0, "pytorch": [0, 2], "pip3": 0, "virtual": 0, "environ": 0, "print": [0, 1, 2, 3, 4], "python": 0, "version": 0, "__version__": 0, "9": [0, 1, 3, 4], "18": [0, 1, 2, 3, 4], "main": [0, 5], "sep": 0, "11": [0, 1, 2, 3, 4], "08": 0, "25": [0, 3, 4], "10": [0, 1, 2, 3, 4], "clang": 0, "14": [0, 2, 3, 4], "0": [0, 1, 2, 3, 4], "6": [0, 2, 3, 4, 5], "26": [0, 3, 4], "4": [0, 2, 3, 4, 5], "The": [0, 5], "packag": [0, 1, 3, 4], "contain": [0, 2, 3, 4], "structur": 0, "multi": 0, "dimension": [0, 1, 2, 3], "tensor": [0, 2, 3, 4], "defin": [0, 2, 3, 4], "mathemat": 0, "oper": [0, 3, 4], "over": [0, 5], "addition": 0, "provid": [0, 3, 5], "mani": [0, 5], "util": [0, 3, 4], "effici": 0, "serial": [0, 4], "arbitrari": 0, "other": [0, 2, 4], "us": [0, 1, 2, 3, 4], "class": [0, 1, 2, 3, 4, 5], "automat": 0, "differenti": 0, "scalar": 0, "valu": [0, 1], "veri": 0, "similar": 0, "syntax": [0, 1], "zero_torch": 0, "zero": [0, 2, 3], "i": [0, 1, 2, 4, 5], "": [0, 1, 2, 3, 5], "format": 0, "str": [0, 3], "simpli": 0, "call": [0, 1, 2, 3, 4], "method": [0, 3, 5], "zero_np": 0, "assert": [0, 1], "all": [0, 1, 3, 4], "correspond": [0, 3, 4], "arrai": [0, 2, 3], "zero_torch_float": 0, "floattensor": 0, "nfloat": 0, "n": [0, 1, 2, 3, 4], "zero_torch_int": 0, "longtensor": 0, "int": [0, 2, 3], "zero_torch_bool": 0, "booltensor": 0, "bool": 0, "reshap": [0, 1], "nview": 0, "new": [0, 3], "shape": [0, 1, 2, 3, 4], "view": 0, "note": 0, "would": [0, 3], "work": 0, "too": [0, 3, 4], "differ": [0, 2], "memori": 0, "handl": 0, "impos": 0, "contigu": 0, "algebra": 0, "randn": [0, 3], "b": [0, 3], "nalgebra": 0, "ar": [0, 1, 2, 3, 4], "overload": 0, "more": [0, 3], "share": 0, "attribut": 0, "float": [0, 3, 4], "fals": [0, 1, 3, 4], "5384": [], "1503": [], "1144": [], "3513": [], "0306": [], "9553": [], "5121": [], "8842": [], "2402": [], "3566": [], "6160": [], "3476": [], "0263": [], "0345": [], "1257": [], "7079": [], "5854": [], "6077": [], "yet": 0, "complic": [0, 1, 2], "than": [0, 3, 4], "It": 0, "basic": 0, "static": 0, "number": [0, 1, 3, 4], "mai": [0, 3], "also": 0, "an": [0, 1, 3, 4], "overlai": 0, "e": [0, 1, 3], "keep": [0, 1, 2, 3, 4, 5], "track": [0, 1, 4], "which": [0, 2], "depend": 0, "To": [0, 1, 3], "access": 0, "embed": 0, "detach": [0, 1, 2, 3, 4], "when": [0, 2], "insid": 0, "perform": [0, 3, 4, 5], "train": [0, 5], "neural": [0, 2, 5], "network": [0, 5], "never": 0, "otherwis": 0, "meta": 0, "inform": 0, "regard": 0, "lost": 0, "effect": 0, "freez": 0, "prevent": 0, "backprop": 0, "howev": 0, "return": [0, 1, 2, 3, 4], "result": 0, "do": [0, 1, 2, 3], "save": [0, 1, 2, 3, 4], "nake": 0, "much": 0, "less": [0, 3, 4], "full": 0, "blown": 0, "prone": 0, "mistak": 0, "bad": 0, "leak": 0, "we": [0, 1, 2, 3, 4, 5], "solv": 0, "theta": 0, "x": [0, 1, 2, 3, 4], "y": [0, 1, 2, 3], "ones": 0, "actual": 0, "default": 0, "doe": [0, 4], "add": 0, "declar": 0, "like": 0, "thi": [0, 1, 2, 3, 4, 5], "forc": 0, "requires_grad": [0, 4], "true": [0, 1, 3, 4], "optimis": 0, "routin": 0, "adam": 0, "sophist": 0, "variant": 0, "sgd": [0, 1, 2, 3, 4], "adapt": 0, "step": [0, 1, 2, 3, 4], "param": [0, 2, 4], "lr": [0, 1, 2, 3, 4], "loss": [0, 2], "initi": [0, 1, 4], "guess": 0, "_": [0, 1, 2, 3, 4], "rang": [0, 1, 2, 3, 4], "100": [0, 1, 2, 3, 4], "By": 0, "accumul": [0, 5], "obtain": 0, "desir": 0, "descent": [0, 1, 2], "beahviour": 0, "clean": 0, "cach": 0, "follow": [0, 1, 2, 3], "line": [0, 1, 2, 3, 4], "zero_grad": [0, 1, 2, 3, 4], "quadrat": 0, "so": [0, 1, 3], "know": 0, "them": [0, 4], "appli": [0, 3], "chain": 0, "rule": 0, "comput": [0, 1, 2, 5], "relev": 0, "backward": [0, 1, 2, 3, 4], "one": [0, 3], "final": 0, "estim": [0, 4], "should": [0, 1], "close": 0, "5290": [], "9945": [], "toylineardata": 0, "toi": [0, 2], "dataset": [0, 1, 2, 3, 4], "linearli": 0, "margin": 0, "gamma": 0, "def": [0, 1, 2, 3, 4], "__init__": [0, 1, 2, 3, 4], "self": [0, 1, 2, 3, 4], "d": [0, 3, 4], "w": [0, 1, 4], "none": [0, 1, 3, 4], "normal": [0, 1, 2, 3, 4], "linalg": [0, 1, 2, 3, 4], "norm": [0, 1, 2, 3, 4], "featur": [0, 1, 2, 5], "label": [0, 1, 2, 3, 4], "max_norm": 0, "w_margin": 0, "1e10": 0, "fill_data": [0, 1], "new_exampl": 0, "max": [0, 1, 2, 3, 4], "min": [0, 1, 2], "ab": [0, 1, 2, 3], "dot": [0, 2, 3], "gaussian": [0, 1], "vector": [0, 3, 4], "mean": [0, 2, 3, 4], "ident": 0, "sqrt": [0, 2, 3, 4], "covari": 0, "move": 0, "direct": 0, "opposit": 0, "guarante": 0, "typic": 0, "have": [0, 5], "normalis": 0, "elif": [0, 1], "__len__": [0, 1], "toysphericaldata": 0, "max_rad": 0, "threshold_rad": 0, "5": [0, 3, 4, 5], "r": [0, 2, 3, 4], "rand": [0, 1], "els": [0, 1, 3, 4], "plot_data": [0, 2], "scatter": [0, 1], "plot": [0, 1, 2, 3, 4], "quit": 0, "slow": 0, "len": [0, 2, 3, 4], "color": [0, 2], "blue": 0, "red": [0, 2], "200": [0, 2, 3, 4], "4f": 0, "axlin": 0, "slope": 0, "c0": 0, "alpha": [0, 1, 2, 3, 4], "hyperplan": 0, "axi": [0, 2, 3], "equal": 0, "0001": [], "3843": [], "9999": 0, "0114": [], "3530575156211855": [], "688069236278534": [], "239160656929016": [], "415073037147522": [], "500": [0, 4], "0411677062511444": [], "0650058686733246": [], "068776363134384": [], "092566841840744": [], "margin_mistake_count": 0, "predict": [0, 3, 4], "update_margin_mistak": 0, "train_perceptron": 0, "alg": 0, "t_lim": 0, "100_000": [0, 1], "converg": 0, "t": [0, 1, 2, 3, 4], "while": [0, 3], "shuffled_indic": 0, "arang": [0, 1, 2, 3, 4], "shuffl": [0, 1], "clean_pass": 0, "file": [0, 1, 3, 4], "token": 0, "indentationerror": 0, "unind": 0, "match": [0, 1], "ani": [0, 1], "outer": 0, "indent": 0, "level": 0, "you": [0, 1, 3], "restart": 0, "again": 0, "cell": [0, 1, 2, 3, 4], "abov": [0, 2], "randint": 0, "marker": [0, 1], "point": [0, 1, 2, 3, 4], "select": 0, "violet": 0, "befor": [0, 3, 4], "lead": 0, "well": 0, "classifi": 0, "updat": 0, "orang": 0, "after": [0, 1, 2], "green": 0, "legend": [0, 1, 2, 4], "show": [0, 1, 2, 3, 4], "2283": 0, "9736": 0, "6492": 0, "7607": 0, "1714": 0, "3209": 0, "1_000_000": 0, "6950": 0, "7190": 0, "6299": 0, "7767": 0, "3983": 0, "5476": 0, "0862": 0, "0950": 0, "4477": 0, "0551": 0, "2822": 0, "2792": 0, "2330": 0, "3312": 0, "4352": 0, "20": [0, 1, 2, 3, 4], "n_d": 0, "n_mc": 0, "all_mistak": 0, "1000": [0, 1, 2, 3, 4], "all_converg": 0, "enumer": [0, 1, 2, 3], "j": [0, 3], "did": 0, "avg_mistak": 0, "std_mistak": 0, "std": 0, "fig": [0, 1, 2, 3], "ax": [0, 1, 2, 3], "subplot": [0, 1, 2, 3], "figsiz": [0, 1, 2, 3], "12": [0, 1, 2, 3, 4], "set_titl": [0, 1, 2, 3], "fill_between": 0, "set_ylim": 0, "sampl": [0, 4], "mean_margin": 0, "n_test": 0, "averag": [0, 3, 4], "error": [0, 1, 4], "score": 0, "01": [0, 1, 2, 3, 4], "30": [0, 1, 2, 3, 4], "n_train": 0, "50": [0, 1, 2, 3, 4], "n_gamma": 0, "number_of_train": 0, "line2d": [0, 3], "0x1652f1c10": 0, "dai": 1, "build": [1, 3, 4, 5], "playground": 1, "test": 1, "properti": 1, "go": [1, 2, 3], "http": [1, 2, 3, 4], "tensorflow": 1, "org": 1, "four": 1, "type": [1, 2, 3], "data": 1, "torch": [1, 2, 3, 4], "question": [1, 2, 4], "write": [1, 2, 3], "two": [1, 2], "fulli": [1, 3, 4], "connect": [1, 3, 4], "dim": [1, 2, 3, 4], "h": [1, 2, 3], "respect": 1, "mlpshallow": [1, 2, 3], "modul": [1, 2, 3, 4], "hidden_dim": [1, 2, 3], "super": [1, 2, 3, 4], "net_typ": [1, 2, 3], "shallow": 1, "info": 1, "your": [1, 3], "code": [1, 2, 3], "here": [1, 2, 3], "forward": [1, 2, 3, 4], "relu": [1, 3, 4], "l1": [1, 3, 4], "lout": [1, 2, 3, 4], "mlpdeep": [1, 2, 3, 4], "deep": [1, 4], "l2": [1, 4, 5], "l3": [1, 4], "l4": 1, "linear": [1, 4, 5], "l5": 1, "try": [1, 2, 3], "simple_f": [1, 2], "maximum": 1, "3": [1, 2, 3, 4, 5], "middle_f": [1, 2], "2": [1, 2, 3, 4, 5], "complex_f": [1, 2], "sin": [1, 2], "co": [1, 2], "linspac": [1, 2, 4], "simpl": [1, 2, 3], "middl": [1, 2], "titl": [1, 2, 3, 4], "target": [1, 2, 3, 4], "gener": [1, 5], "batch": [1, 3, 4], "respons": [1, 3], "pair": 1, "form": 1, "x_i": 1, "nois": 1, "xmin": [1, 2], "xmax": [1, 2], "noise_level": [1, 2], "1e": 1, "varianc": [1, 3, 4], "input": [1, 2, 3, 4], "empti": [1, 3], "output": [1, 2, 3, 4], "fill": 1, "pass_ord": 1, "everi": [1, 3, 4], "time": [1, 2], "through": 1, "current_posit": 1, "current": [1, 4], "posit": 1, "pass": [1, 2], "order": 1, "true_f": 1, "complex": [1, 2, 5], "next_batch": [1, 2], "batch_siz": [1, 2, 3, 4], "po": 1, "indic": 1, "input_batch": 1, "stack": 1, "output_batch": 1, "15": [1, 2, 3, 4], "avail": 1, "linestyl": [1, 2], "In": [1, 4, 5], "section": 1, "given": [1, 3, 4], "observ": [1, 2, 3], "mlp": [1, 2, 3], "total_train_step": 1, "log": [1, 2, 4], "all_loss": [1, 2], "n_point": [1, 2], "no_grad": [1, 2, 3, 4], "nn_valu": 1, "true_val": 1, "approx": 1, "squar": [1, 3, 4], "o": [1, 3], "pred": 1, "At": [1, 2], "0932499235305304": 1, "09431945941353115": [], "text": [1, 2], "least": [1, 4], "minim": 1, "frac": 1, "sum_": 1, "h_w": 1, "y_i": 1, "standard": [1, 5], "procedur": 1, "stochast": [1, 5], "gradient": [1, 2, 3, 4], "weight": [1, 2, 3], "w_": [1, 2, 3], "w_t": 1, "mathrm": 1, "cdot": [1, 4], "nabla_w": 1, "where": [1, 2, 3, 4], "come": [1, 5], "back": 1, "tune": 1, "learn": [1, 4], "rate": 1, "paramet": [1, 2, 3, 4], "001": [1, 2, 3, 4], "criterion": [1, 2, 3, 4], "mseloss": [1, 2, 3], "tp1": 1, "need": 1, "remind": 1, "n_step": [1, 2], "100000": [1, 2], "append": [1, 2, 3, 4], "total": [1, 3, 4], "latest": 1, "3000000": [], "keyboardinterrupt": [1, 3], "traceback": [1, 2, 3, 4], "most": [1, 4], "recent": [1, 2, 3, 4, 5], "last": [1, 2, 3, 4], "27": [3, 4], "28": [3, 4], "anaconda3": [1, 3, 4], "env": [1, 3, 4], "py39": [1, 3, 4], "lib": [1, 3, 4], "python3": [1, 3, 4], "site": [1, 3, 4], "py": [1, 2, 3, 4], "527": [], "arg": 1, "kwarg": 1, "483": [], "484": [], "displai": [], "open": 3, "figur": [], "485": [], "524": [], "explicitli": [], "525": [], "526": [], "_warn_if_gui_out_of_main_thread": [], "_get_backend_mod": [], "matplotlib_inlin": [], "backend_inlin": [], "90": [3, 4], "block": [], "88": [3, 4], "89": [3, 4], "figure_manag": [], "gcf": [], "get_all_fig_manag": [], "91": [3, 4], "canva": [], "92": [3, 4], "metadata": [], "_fetch_figure_metadata": [], "93": [3, 4], "94": [3, 4], "95": [3, 4], "_to_draw": [], "ipython": [], "core": 5, "display_funct": [], "298": [], "includ": [], "exclud": [], "transient": [], "display_id": [], "raw": [3, 4], "clear": [], "obj": 4, "296": [], "publish_display_data": [], "297": [], "format_dict": [], "md_dict": [], "299": [], "300": [2, 3], "noth": [], "g": 1, "_ipython_display_": [], "took": [], "301": [], "continu": [2, 3], "formatt": [], "179": [], "displayformatt": [], "177": [], "md": [], "178": [], "180": [], "except": [1, 3], "181": [], "fixm": [], "182": [], "rais": 3, "decor": 1, "232": [], "local": [1, 3], "fun": [], "kw": [], "230": [], "kwsyntax": [], "231": [], "fix": [], "sig": [], "caller": [], "func": [], "extra": [], "223": [], "catch_format_error": [], "221": [], "fail": 3, "222": [], "224": [], "notimplementederror": [], "225": [], "don": [], "warn": [], "226": [], "_check_return": [], "340": [], "baseformatt": [], "__call__": 1, "338": [], "339": [], "printer": [], "341": [], "look": [1, 2], "special": [], "name": [2, 4], "342": [], "get_real_method": [], "print_method": [], "pylabtool": [], "152": [], "print_figur": [], "fmt": [], "bbox_inch": [], "base64": [], "149": [], "backend_bas": [], "figurecanvasbas": [], "150": 2, "bytes_io": [], "153": [], "getvalu": [], "154": [], "svg": [], "2193": [], "filenam": [1, 3], "dpi": [], "facecolor": [], "edgecolor": [], "orient": [], "pad_inch": [], "bbox_extra_artist": [], "backend": [], "2189": [], "2190": [], "_get_render": [], "chang": [], "2191": [], "72": [3, 4], "set": [3, 4], "2192": [], "cbook": [], "_setattr_cm": [], "2194": [], "2195": [], "2196": [], "2197": [], "2198": [], "bbox_inches_restor": [], "_bbox_inches_restor": [], "2199": [], "2200": [], "2201": [], "restore_bbox": [], "2043": [], "_switch_canvas_and_return_print_method": [], "lambda": 3, "2039": [], "optional_kw": [], "render": [], "2040": [], "2041": [], "2042": [], "skip": [], "inspect": 1, "signatur": [], "meth": [], "functool": 1, "wrap": 1, "2044": [], "k": [2, 3, 4], "v": 3, "item": [], "2045": [], "let": [2, 3], "third": [], "parti": [], "thei": [], "see": [2, 4], "fit": [], "2046": [], "backend_agg": [], "497": [], "figurecanvasagg": [], "print_png": [], "filename_or_obj": [], "pil_kwarg": [], "450": [], "451": [], "452": [], "png": [], "453": [], "495": [], "softwar": [], "kei": [], "496": [], "_print_pil": [], "445": [], "440": [], "441": [], "442": [], "draw": [], "imag": [2, 3, 4], "imsav": [], "443": [], "444": [], "446": [], "mpl": [], "447": [], "buffer_rgba": [], "origin": [], "upper": 4, "448": [], "388": [], "385": [], "acquir": [], "lock": [], "font": [], "386": [], "toolbar": [], "_wait_cursor_for_draw_cm": [], "387": [], "nullcontext": [], "389": [], "A": [], "gui": [], "window": [], "390": [], "forget": 1, "superclass": [], "391": [], "artist": [], "_finalize_raster": [], "draw_wrapp": [], "96": [3, 4], "_raster": [], "97": [3, 4], "stop_raster": [], "allow_raster": [], "69": [3, 4], "get_agg_filt": [], "70": [3, 4], "start_filt": [], "73": [3, 4], "74": [3, 4], "3154": [], "3151": [], "valueerror": 1, "occur": 2, "resiz": [], "3153": [], "patch": [], "mimag": [], "_draw_list_compositing_imag": [], "3155": [], "suppresscomposit": [], "3157": [], "sfig": [], "subfig": [], "3158": [], "132": [], "parent": 4, "suppress_composit": [], "130": [], "not_composit": [], "has_imag": [], "131": [], "133": [], "134": [], "composit": [], "adjac": [], "togeth": [], "135": [], "image_group": [], "_base": [], "3070": [], "_axesbas": [], "3067": [], "artists_raster": [], "3068": [], "_draw_raster": [], "3071": [], "3073": [], "close_group": [], "3074": [], "stale": [], "801": [], "798": [], "gc": [], "set_foreground": [], "lc_rgba": [], "isrgba": [], "800": [], "set_dash": [], "_dash_pattern": [], "draw_path": [], "tpath": [], "affin": [], "frozen": 2, "802": [], "restor": [], "804": [], "_marker": [], "_markers": [], "rendereragg": [], "path": [1, 2, 3], "transform": [3, 4], "rgbface": [], "_render": [], "overflowerror": [], "cant_chunk": [], "28210000": 1, "0924277368953708": 1, "30000": 1, "until": [1, 3], "good": [1, 4, 5], "000": 1, "architectur": 1, "three": 1, "10000": [1, 2], "all_data_typ": 1, "all_net_typ": 1, "net_shallow": 1, "net_deep": 1, "practic": [1, 5], "For": 1, "hyperparamet": 1, "each": [1, 3, 4], "problem": [1, 2], "separ": 1, "monitor": 1, "state": 1, "dure": 1, "snippet": [1, 2], "pth": [1, 2, 3], "state_dict": [1, 2, 3, 4], "load_state_dict": [1, 2, 3, 4], "load": [1, 2, 3, 4], "With": [2, 4], "inspir": 2, "rajatvd": 2, "github": 2, "io": 2, "ntk": [2, 5], "optim": [2, 3, 5], "exectut": 2, "script": 2, "tp3_util": 2, "take": 2, "quick": 2, "implement": [2, 3], "load_ext": 2, "autoreload": 2, "week": 2, "1": [2, 3, 4, 5], "regress": 2, "net": [2, 3, 4, 5], "save_weights_everi": 2, "save_weight": 2, "plot_net": 2, "nameerror": 2, "7": [1, 2, 3, 4, 5], "8": [1, 2, 3, 4], "16": [2, 3, 4], "13": [2, 3, 4], "19": [1, 2, 3, 4], "famili": 2, "sinusoid": 2, "map": 2, "phi": 2, "pi": [2, 3, 4], "2k": 2, "feature_dim": 2, "linsin": 2, "assum": 2, "even": 2, "weight_histori": 2, "concaten": 2, "l": [2, 4], "list": [2, 4], "loglog": 2, "all_weights1": 2, "weight_evol": [2, 3], "rel": [2, 3], "movement": 2, "layer": [2, 3, 4, 5], "what": [2, 3], "u": [2, 3, 4], "now": [2, 3], "repeat": [2, 4], "larg": [2, 4], "dimens": 2, "run": 2, "instanc": 2, "signific": 2, "between": [2, 3, 4, 5], "model_list": 2, "n_model": 2, "all_weight": 2, "some": [2, 3, 4, 5], "how": 2, "5000": 2, "vari": 2, "width": [2, 3], "our": [2, 5], "happen": 2, "width_list": 2, "simul": 2, "xlim": 2, "attempt": [2, 3], "enter": 2, "scaledmodel": 2, "base": 2, "creat": [2, 3, 4], "factor": [2, 3], "base_model": 2, "trick": 2, "hide": 2, "dictionari": 2, "probabl": [2, 4], "proper": 2, "wai": [2, 4], "subtract": 2, "2000": [2, 3, 4], "new_model": 2, "rf": [2, 3, 4], "explain": [2, 5], "below": [2, 3], "blog": 2, "post": 2, "w_0": 2, "exp": 2, "linh": 2, "xy": [2, 3], "sum": [2, 3, 4], "linl": 2, "delta": [2, 3, 4], "landscap": 2, "grid": [2, 3, 4], "named_paramet": 2, "shifted_a": 2, "evol": 2, "succes": 2, "shifted_weight": 2, "p": [2, 3, 4], "size": [2, 3, 4], "xxt": [2, 3], "transpos": [2, 3, 4], "top": [2, 3, 4], "imshow": [2, 3, 4], "eigval": [2, 3], "eigh": [2, 3], "diagon": [2, 3], "matrix_rank": [2, 3], "2872850938240181": 2, "eta": [2, 3], "squeez": [2, 3], "distanc": [2, 3], "init": [2, 3, 4], "onli": [1, 2, 3, 4], "low": [2, 3], "subspac": [2, 3], "40": [2, 3, 4], "ws_in_bas": [2, 3], "colorbar": [2, 3], "tight_layout": [2, 3], "bia": [2, 3], "tradeoff": 2, "npoint": 2, "05": 2, "true_risk": 2, "risk": 2, "axhlin": 2, "0026": 2, "train_loss": 2, "var_train": 2, "local_risk": 2, "var": 2, "0x29090d610": 2, "torchvis": [3, 4], "todai": 3, "studi": [3, 5], "compar": 3, "behavior": 3, "exampl": 3, "fashionmnist": [3, 4], "small": 3, "binari": [3, 4], "classif": [3, 4], "task": [3, 4], "those": [3, 5], "c1": [3, 4], "c2": [3, 4], "subclass": [3, 4], "kept": [3, 4], "make": [3, 4], "sure": [3, 4], "32": [3, 4], "shirt": [3, 4], "trouser": [3, 4], "pullov": [3, 4], "dress": [3, 4], "coat": [3, 4], "sandal": [3, 4], "sneaker": [3, 4], "bag": [3, 4], "ankl": [3, 4], "boot": [3, 4], "sequenc": [3, 4], "totensor": [3, 4], "object": [3, 4], "put": [3, 4], "pixel": [3, 4], "compos": [3, 4], "substitut": [3, 4], "mnist": [3, 4], "becaus": [3, 4], "easi": [3, 4], "trainset": [3, 4], "download": [3, 4], "idxc1": [3, 4], "as_tensor": [3, 4], "x1": [3, 4], "cumsum": [3, 4], "idxc2": [3, 4], "x2": [3, 4], "idx": [3, 4], "dset_train": [3, 4], "subset": [3, 4], "trainload": [3, 4], "dataload": [3, 4], "testset": [3, 4], "root": [3, 4], "dset_test": [3, 4], "testload": [3, 4], "fashion": [3, 4], "s3": [3, 4], "websit": [3, 4], "eu": [3, 4], "central": [3, 4], "amazonaw": [3, 4], "com": [3, 4], "idx3": [3, 4], "ubyt": [3, 4], "gz": [3, 4], "next": [3, 4], "urlopen": 3, "errno": [], "nodenam": [], "nor": [], "servnam": [], "known": [], "runtimeerror": [3, 4], "29": [3, 4], "21": [1, 3, 4], "22": [1, 3, 4], "23": [3, 4], "24": [1, 3, 4], "31": [3, 4], "33": [3, 4], "99": [3, 4], "target_transform": 3, "98": [3, 4], "101": 3, "_check_exist": 3, "102": 3, "found": 3, "195": [], "193": [], "break": 3, "194": [], "img": [3, 4], "unnorm": [3, 4], "npimg": [3, 4], "get": [3, 4], "datait": [3, 4], "iter": [3, 4], "make_grid": [3, 4], "join": 3, "hidden": [3, 4], "flatten": [3, 4], "treat": [3, 4], "xavier_normal_": 3, "zeros_": 3, "n_pass": [3, 4], "vector_norm": [3, 4], "unsqueez": 3, "ylim": [3, 4], "1400": 3, "complet": 3, "interpol": 3, "correct": [3, 4], "accuraci": [3, 4], "grndtruth": 3, "infinit": 3, "limit": 3, "formula": 3, "seen": 3, "train_set": 3, "xprime": 3, "avoid": 3, "nan": 3, "arcco": 3, "ep": 3, "round": 3, "99999": 3, "ntrainload": 3, "start_dim": 3, "end_dim": 3, "xi": 3, "eigenvalu": 3, "eigvalsh": 3, "smallest": 3, "sort": 3, "hinv": 3, "inv": 3, "gen_bound": 3, "999999": 3, "784": 3, "512008666992188": 3, "ntk_trainload": 3, "correct_ntk": 3, "output_ntk": 3, "predicted_ntk": 3, "why": 3, "correct_net": 3, "agre": 3, "both": 3, "86": [3, 4], "bound": [3, 5], "n_valu": 3, "400": 3, "195989608764648": 3, "700": 3, "155244827270508": 3, "420177936553955": 3, "1300": 3, "3553948402404785": 3, "1600": 3, "308578968048096": 3, "1900": 3, "274092197418213": 3, "0x147f2fd30": 3, "smaller": 3, "largest": 3, "xx": 3, "963392764546683": 3, "hedi": [4, 5], "theoret": 4, "principl": 4, "c": 4, "upsaclai": 4, "illustr": 4, "35": [3, 4], "36": [3, 4], "store": 4, "w0": 4, "total_paramet": 4, "numel": 4, "98902": 4, "crossentropyloss": 4, "model": [4, 5], "trained_net": 4, "pt": 4, "3150": 4, "argmax": 4, "kl": 4, "q": 4, "klprime": 4, "klinvert": 4, "pacbayesbound": 4, "everyth": 4, "prior": 4, "posterior": 4, "nsampl": 4, "02": 4, "deltaprim": 4, "w_post": 4, "sigma_post": 4, "ones_lik": 4, "lambda_max": 4, "sigmaprior": 4, "09": 4, "final_bound_valu": 4, "kl_g": 4, "dw": 4, "logterm": 4, "param_": 4, "param_w": 4, "param_w0": 4, "zip": 4, "meta_prior_cost": 4, "first": 4, "second": 4, "full_kl_bound": 4, "conf": 4, "metaprior": 4, "estimate_sample_error": 4, "m": 4, "accord": 4, "evalu": 4, "sample_net": 4, "zeros_lik": 4, "error_estim": 4, "final_bound": 4, "todo": 4, "real": 4, "half_bound": 4, "full_bound": 4, "success_prob": 4, "under": 4, "optimize_bound": 4, "all_paramet": 4, "perturbed_net": 4, "12836254": 4, "12831238": 4, "03800004720687866": 4, "1000000": 4, "cheat": 4, "fake": 4, "chanc": 4, "9900000095367432": 4, "0485": 4, "426172256469727": 4, "interest": 4, "find": 4, "examin": 4, "interpret": 4, "investig": 4, "flat": 4, "minimum": 4, "hypothesi": 4, "experi": 4, "dtv": 4, "klval": 4, "tvval": 4, "invers": 4, "499": 4, "fr": [4, 5], "td": [], "singl": 5, "perceptron": 5, "up": [], "tp2": [], "approxim": 5, "tp3": [], "lazi": 5, "non": [1, 5], "scale": [], "right": [], "basi": [], "coordin": [], "dont": [], "jupyt": [], "book": [], "document": [], "detail": [], "instruct": [], "page": [], "off": [], "written": [], "built": [], "content": 3, "execut": [], "kernel": 5, "rest": [], "jupytext": [], "convert": [], "support": [], "thing": [], "understand": [], "about": [], "presenc": [], "That": [], "start": [], "command": [], "markdownfil": [], "As": 5, "emb": [], "html": [], "etc": [], "add_": [], "math": 5, "begin": [], "align": [], "mbox": [], "la_": [], "tex": [], "end": [], "But": [], "escap": [], "dollar": [], "sign": [], "want": [], "check": [], "out": 3, "guid": [], "rcparam": [], "cycler": [], "ion": [], "contextlib": [], "exitstack": [], "0x1053b6a60": [], "reproduc": [], "seed": [], "19680801": [], "logspac": [], "ii": [], "cmap": [], "cm": [], "coolwarm": [], "prop_cycl": [], "custom_lin": [], "lw": [], "cold": [], "medium": [], "hot": [], "There": [], "lot": [], "interact": [], "tp5": [], "tangent": 5, "gram": [], "matrix": [], "invert": [], "overparameter": 5, "tp6": [], "pac": 5, "bay": 5, "pinsker": [], "inequ": [], "0993": [], "6203": [], "1800": [], "9332": [], "1464": [], "4709": [], "1328": [], "1496": [], "2214": [], "1273": [], "1449": [], "5702": [], "7531": [], "1662": [], "4014": [], "0606": [], "2914": [], "8414": [], "9853": [], "0010": [], "3466": [], "4226": [], "9063": [], "8743070125579835": [], "8612986564636231": [], "5430360078811645": [], "9643035173416137": [], "0447706997394561": [], "0734225332736969": [], "0631816655397415": [], "0618405014276504": [], "08604660032322863": [], "1511": [], "_wrapped_call_impl": [], "1509": [], "_compiled_call_impl": [], "ignor": 3, "misc": [], "1510": [], "_call_impl": [], "1520": [], "1515": [], "hook": [], "logic": [], "1516": [], "just": [], "1517": [], "_backward_hook": [], "_backward_pre_hook": [], "_forward_hook": [], "_forward_pre_hook": [], "1518": [], "_global_backward_pre_hook": [], "_global_backward_hook": [], "1519": [], "_global_forward_hook": [], "_global_forward_pre_hook": [], "forward_cal": [], "1522": [], "1523": [], "535": [], "534": [], "mse_loss": [], "reduct": [], "3339": [], "size_averag": [], "reduc": [], "3336": [], "_reduct": [], "legacy_get_str": [], "3338": [], "expanded_input": [], "expanded_target": [], "broadcast_tensor": [], "_c": 4, "_nn": [], "get_enum": [], "17": [1, 3, 4], "34": [3, 4], "37": [3, 4], "38": [3, 4], "39": [3, 4], "41": [3, 4], "42": [3, 4], "43": [3, 4], "44": [1, 3, 4], "45": [1, 3, 4], "46": [1, 3, 4], "47": [1, 3, 4], "48": [1, 3, 4], "49": [3, 4], "51": [3, 4], "52": [3, 4], "53": [3, 4], "54": [3, 4], "55": [3, 4], "56": [3, 4], "57": [3, 4], "58": [3, 4], "59": [3, 4], "60": [3, 4], "61": [3, 4], "62": [3, 4], "63": [3, 4], "64": [3, 4], "65": [3, 4], "66": [3, 4], "67": [3, 4], "68": [3, 4], "71": [3, 4], "75": [3, 4], "76": [3, 4], "77": [3, 4], "78": [3, 4], "79": [3, 4], "80": [3, 4], "81": [3, 4], "82": [3, 4], "83": [3, 4], "84": [3, 4], "85": [3, 4], "87": [3, 4], "extract": [3, 4], "idx1": [3, 4], "t10k": [3, 4], "momentum": [], "dampen": [], "weight_decai": [], "nesterov": [], "maxim": [], "foreach": [], "requir": [], "273": [], "271": [], "param_group": [], "272": [], "got": [], "274": [], "isinst": [], "dict": [], "275": [], "628": 4, "pickle_modul": 4, "pickle_protocol": 4, "_use_new_zipfile_seri": 4, "_disable_byteorder_record": 4, "625": 4, "_check_save_filelik": 4, "627": 4, "_open_zipfile_writ": 4, "opened_zipfil": 4, "629": 4, "_save": 4, "630": 4, "502": [3, 4], "name_or_buff": 4, "501": 4, "_open_zipfile_writer_buff": 4, "473": 4, "_open_zipfile_writer_fil": 4, "471": 4, "pytorchfilewrit": 4, "file_stream": 4, "472": 4, "directori": 4, "exist": [1, 4], "0x1064d8cd0": [], "0514": [], "6854": [], "2533": [], "3239": [], "0809": [], "4531": [], "6086": [], "8841": [], "6804": [], "0071": [], "4571": [], "7025": [], "6600": [], "1987": [], "9337": [], "3310": [], "3762": [], "1556": [], "9409": [], "9820": [], "0013": [], "1950": [], "7781": [], "6282": [], "960903126001358": [], "8677626430988312": [], "4026930212974547": [], "2392587542533873": [], "0874035000801086": [], "082511031627655": [], "0864513635635376": [], "0809491395950317": [], "087873030589486": [], "introduct": 5, "concept": 5, "slide": [], "barron": 5, "theorem": 5, "regim": 5, "rademach": 5, "definit": 5, "macallest": 5, "mysteri": 5, "edg": 5, "stabil": 5, "univers": 5, "insight": 5, "concentr": 5, "vacuou": 5, "machin": 5, "algorithm": 5, "involv": 5, "empir": 5, "success": 5, "spectacular": 5, "year": 5, "accomplish": 5, "cannot": 5, "convent": 5, "wisdom": 5, "theori": 5, "moreov": [], "popular": 5, "grow": 5, "gap": 5, "widen": 5, "groundwork": 5, "satisfi": [3, 5], "ultim": 5, "valuabl": 5, "practition": 5, "major": 5, "challeng": 5, "modern": 5, "research": 5, "discuss": 5, "progress": 5, "made": 5, "toward": 5, "describ": 5, "focu": 5, "surprisingli": 5, "abil": 5, "instructor": 5, "centralesupelec": 5, "m2": 5, "ia": 5, "universit\u00e9": 5, "pari": 5, "saclai": 5, "centralesup\u00e9lec": 5, "reach": 5, "me": 5, "0182": 0, "6023": 0, "4773": 0, "3301": 0, "4343": 0, "6200": 0, "6202": 0, "7213": 0, "7796": 0, "3127": 0, "1968": 0, "1540": 0, "6383": 0, "1190": 0, "3023": 0, "6428": 0, "6311": 0, "7741": 0, "2107": 0, "0003": 0, "3916": 0, "9969": 0, "0788": 0, "208884280920029": 0, "5589091002941133": 0, "0815599977970125": 0, "441225749254227": 0, "0394978940486908": 0, "0771204650402069": 0, "0675497114658357": 0, "0754001200199128": 0, "08509111325140929": 1, "_compil": 1, "_disable_dynamo": 1, "inner": 1, "fn": 1, "_dynamo": 1, "disabl": 1, "recurs": 1, "innermost_fn": 1, "callabl": 1, "disablecontext": 1, "eval_fram": 1, "437": 1, "_torchdynamocontext": 1, "434": 1, "436": 1, "getsourcefil": 1, "438": 1, "typeerror": 1, "439": 1, "706": [1, 3], "703": [1, 3], "endswith": 1, "704": [1, 3], "importlib": 1, "machineri": 1, "extension_suffix": 1, "705": [1, 3], "707": 1, "708": 1, "ha": 1, "pep": 1, "302": 1, "loader": 1, "genericpath": 1, "whether": 1, "broken": 1, "symbol": 1, "link": 1, "stat": 1, "oserror": [1, 3], "187": 3, "185": 3, "186": 3, "url": 3, "download_and_extract_arch": 3, "download_root": 3, "raw_fold": 3, "md5": 3, "188": 3, "urlerror": 3, "189": 3, "378": 3, "extract_root": 3, "remove_finish": 3, "375": 3, "376": 3, "basenam": 3, "download_url": 3, "380": 3, "archiv": 3, "381": 3, "140": 3, "max_redirect_hop": 3, "138": 3, "139": 3, "fpath": 3, "_urlretriev": 3, "141": 3, "urllib": 3, "attr": 3, "142": 3, "chunk_siz": 3, "1024": 3, "request": 3, "header": 3, "user": 3, "agent": 3, "user_ag": 3, "_save_response_cont": 3, "read": 3, "length": 3, "destin": 3, "byte": 3, "option": 3, "wb": 3, "fh": 3, "tqdm": 3, "pbar": 3, "chunk": 3, "filter": 3, "aliv": 3, "client": 3, "463": 3, "httprespons": 3, "amt": 3, "460": 3, "461": 3, "amount": 3, "readinto": 3, "462": 3, "bytearrai": 3, "464": 3, "memoryview": 3, "tobyt": 3, "465": 3, "466": 3, "unbound": 3, "must": 3, "467": 3, "507": 3, "504": 3, "_safe_read": 3, "will_clos": 3, "505": 3, "506": 3, "1k": 3, "fp": 3, "508": 3, "509": 3, "ideal": 3, "incompleteread": 3, "510": 3, "wasn": 3, "might": 3, "compat": 3, "511": 3, "_close_conn": 3, "socket": 3, "socketio": 3, "702": 3, "_sock": 3, "recv_into": 3, "timeout": 3, "_timeout_occur": 3, "verifi": 4}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"td": 0, "1": [0, 1], "singl": 0, "layer": 0, "perceptron": 0, "torch": 0, "101": 0, "variabl": 0, "type": 0, "gradient": 0, "manag": 0, "set": 0, "up": 0, "experi": 0, "data": [0, 2, 3, 4], "2": 0, "implement": 0, "3": 0, "test": [0, 2, 3, 4], "run": 0, "code": 0, "below": 0, "few": 0, "time": 0, "see": 0, "how": 0, "behav": 0, "non": [0, 2], "separ": 0, "just": 0, "algorithm": 0, "higher": 0, "dim": 0, "check": [0, 3, 4], "optim": [0, 1, 4], "gener": [0, 3], "tp2": 1, "approxim": 1, "neural": [1, 3, 4], "network": [1, 2, 3, 4], "warmup": 1, "defin": 1, "our": 1, "object": 1, "train": [1, 2, 3, 4], "net": 1, "some": 1, "arbitrari": 1, "function": [1, 2, 3, 4], "4": 1, "loss": [1, 3, 4], "5": [1, 2], "compar": 1, "perform": 1, "differ": 1, "depth": 1, "tp3": 2, "lazi": 2, "The": [2, 3, 4], "your": 2, "A": [2, 3, 4], "linear": [2, 3], "model": 2, "robust": 2, "fast": 2, "converg": 2, "thin": 2, "v": 2, "wide": 2, "bad": 2, "initi": 2, "can": 2, "you": 2, "get": 2, "out": 2, "regim": 2, "scale": 2, "effect": 2, "1d": 2, "piec": 2, "In": [2, 3], "right": [2, 3], "basi": [2, 3], "most": [2, 3], "coordin": [2, 3], "w": [2, 3], "dont": [2, 3], "move": [2, 3], "tp5": 3, "tangent": 3, "kernel": 3, "valu": [3, 4], "ntk": 3, "error": 3, "gram": 3, "matrix": 3, "i": 3, "typic": 3, "invert": 3, "overparameter": 3, "regress": 3, "tp6": 4, "pac": 4, "bay": 4, "bound": 4, "pinsker": 4, "": 4, "inequ": 4, "etc": 4, "tp": [], "theoret": 5, "principl": 5, "deep": 5, "learn": 5, "class": [], "notebook": [], "myst": [], "markdown": [], "an": [], "exampl": [], "cell": [], "creat": [], "quickli": [], "add": [], "yaml": [], "metadata": [], "content": [], "block": [], "output": [], "slide": 5, "cours": 5, "descript": 5}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9, "sphinx": 60}, "alltitles": {"TD 1: Single Layer Perceptron": [[0, "td-1-single-layer-perceptron"]], "Torch 101": [[0, "torch-101"]], "Variable types": [[0, "variable-types"]], "Gradient management": [[0, "gradient-management"]], "Setting up a Perceptron experiment": [[0, "setting-up-a-perceptron-experiment"]], "1 - Data": [[0, "data"]], "2 - Implementing the Perceptron": [[0, "implementing-the-perceptron"]], "3 - Testing the Perceptron": [[0, "testing-the-perceptron"]], "Run the code below a few times to see how the Perceptron behaves.": [[0, "run-the-code-below-a-few-times-to-see-how-the-perceptron-behaves"]], "Non-separable data": [[0, "non-separable-data"]], "Just run the algorithm in higher dim to check": [[0, "just-run-the-algorithm-in-higher-dim-to-check"]], "2 - Optimization of the Perceptron": [[0, "optimization-of-the-perceptron"]], "2- Generalization": [[0, "generalization"]], "TP2 : Approximation with neural networks": [[1, "tp2-approximation-with-neural-networks"]], "Warmup:": [[1, "warmup"]], "1.  Define our network": [[1, "define-our-network"]], "Objective: Train a neural net to approximate some arbitrary functions": [[1, "objective-train-a-neural-net-to-approximate-some-arbitrary-functions"]], "4. Train a network": [[1, "train-a-network"]], "Training": [[1, "training"]], "Defining the optimizer and loss": [[1, "defining-the-optimizer-and-loss"]], "5 - Compare the performances on different functions for different depths.": [[1, "compare-the-performances-on-different-functions-for-different-depths"]], "TP3 : Lazy training": [[2, "tp3-lazy-training"]], "The data": [[2, "the-data"], [3, "the-data"], [4, "the-data"]], "The training function": [[2, "the-training-function"], [3, "the-training-function"], [4, "the-training-function"]], "Test your training": [[2, "test-your-training"]], "A linear model": [[2, "a-linear-model"]], "Robustness of fast convergence for linear models": [[2, "robustness-of-fast-convergence-for-linear-models"]], "Lazy training of non-linear models": [[2, "lazy-training-of-non-linear-models"]], "Thin vs. Wide networks": [[2, "thin-vs-wide-networks"]], "Bad initialization can you get you out of the Lazy regime": [[2, "bad-initialization-can-you-get-you-out-of-the-lazy-regime"]], "Scaling": [[2, "scaling"]], "5 - The effect of scaling on a 1D model": [[2, "the-effect-of-scaling-on-a-1d-model"]], "Pieces": [[2, "pieces"]], "In the right basis, most coordinates of w dont move": [[2, "in-the-right-basis-most-coordinates-of-w-dont-move"], [3, "in-the-right-basis-most-coordinates-of-w-dont-move"]], "TP5 : Neural Tangent Kernel": [[3, "tp5-neural-tangent-kernel"]], "A neural network": [[3, "a-neural-network"], [4, "a-neural-network"]], "Checking the training values": [[3, "checking-the-training-values"], [4, "checking-the-training-values"]], "Test loss": [[3, "test-loss"], [4, "test-loss"]], "The NTK": [[3, "the-ntk"]], "Generalization error": [[3, "generalization-error"]], "The NTK Gram matrix is typically invertible": [[3, "the-ntk-gram-matrix-is-typically-invertible"]], "Overparameterized linear regression": [[3, "overparameterized-linear-regression"]], "TP6 : PAC-Bayes": [[4, "tp6-pac-bayes"]], "PAC Bayes bound optimization": [[4, "pac-bayes-bound-optimization"]], "Pinsker\u2019s inequality, etc.": [[4, "pinsker-s-inequality-etc"]], "Theoretical Principles of Deep Learning": [[5, "theoretical-principles-of-deep-learning"]], "Course Description": [[5, "course-description"]], "Slides": [[5, "slides"]]}, "indexentries": {}})